#!/usr/bin/env bash
# Conditionally start 1Password and wire up its SSH agent.
# No-op on systems without 1Password installed.

command -v 1password &>/dev/null || exit 0

# Start 1Password in the background (tray mode)
1password --silent &
disown

# Point SSH at 1Password's agent socket
export SSH_AUTH_SOCK="$HOME/.1password/agent.sock"

# Propagate to D-Bus activated apps and systemd user services
dbus-update-activation-environment --systemd SSH_AUTH_SOCK 2>/dev/null
