#!/usr/bin/env bash
# Configure vim on first run - install plugins and extensions

set -e

echo "üîß Configuring Vim for first-time use..."
echo

# Step 1: Install vim-plug plugins
echo "üì¶ Installing vim plugins via vim-plug..."
if vim +PlugInstall +qall; then
    echo "‚úÖ Vim plugins installed successfully"
else
    echo "‚ùå Failed to install vim plugins"
    exit 1
fi
echo

# Step 2: Install coc.nvim extensions
echo "üîå Installing coc.nvim language server extensions..."
if vim -c "CocInstall -sync coc-pyright coc-tsserver coc-rust-analyzer coc-json coc-go" -c "qall"; then
    echo "‚úÖ Coc extensions installed successfully"
else
    echo "‚ö†Ô∏è  Warning: Some coc extensions may have failed to install"
fi
echo

# Step 3: Verify setup
echo "üîç Verifying vim configuration..."
if vim -c "version" -c "qall" 2>&1 | grep -q "VIM"; then
    echo "‚úÖ Vim configuration verified"
else
    echo "‚ö†Ô∏è  Warning: Vim verification check had issues"
fi
echo

echo "‚ú® Vim configuration complete!"
echo
echo "Next steps:"
echo "  1. Run 'vim' to start editing"
echo "  2. Run ':Copilot setup' in vim for GitHub Copilot (optional)"
echo "  3. Run ':checkhealth' to verify LSP servers are installed"
echo
echo "Keybindings:"
echo "  <Space>ff  - Find files"
echo "  <Space>fg  - Grep search"
echo "  <Space>e   - Toggle file explorer"
echo "  gd         - Go to definition"
echo "  K          - Show documentation"
echo "  <Tab>      - Accept Copilot suggestion"
